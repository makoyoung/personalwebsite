<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Safe URL & Instagram Opener - Mako Young</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            background-color: #f9fafb; /* gray-50 */
            color: #1f2937; /* gray-800 */
            background-image: radial-gradient(#e5e7eb 1px, transparent 1px);
            background-size: 2rem 2rem;
        }
        /* Navbar Styles */
        .navbar {
            background-color: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            position: sticky;
            top: 0;
            z-index: 50;
        }
        .navbar .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1280px;
            margin-left: auto;
            margin-right: auto;
        }
        .navbar-brand {
            font-size: 1.25rem;
            font-weight: 700;
            color: #111827;
            text-decoration: none;
        }
        .navbar-links {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }
        .navbar-links a {
            color: #4b5563;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }
        .navbar-links a:hover {
            color: #1d4ed8;
        }
        .navbar-button {
            padding: 0.625rem 1.25rem;
            font-weight: 600;
            border-radius: 0.5rem;
            background-color: #2563eb;
            color: white !important;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(37, 99, 235, 0.1), 0 1px 3px rgba(0,0,0,0.08);
            text-decoration: none;
        }
        .navbar-button:hover {
            background-color: #1d4ed8;
            transform: translateY(-2px);
            box-shadow: 0 7px 14px rgba(37, 99, 235, 0.1), 0 3px 6px rgba(0,0,0,0.08);
        }

         /* Custom scrollbar */
        textarea::-webkit-scrollbar, pre::-webkit-scrollbar {
            width: 8px;
        }
        textarea::-webkit-scrollbar-track, pre::-webkit-scrollbar-track {
            background: #e5e7eb; /* gray-200 */
        }
        textarea::-webkit-scrollbar-thumb, pre::-webkit-scrollbar-thumb {
            background-color: #9ca3af; /* gray-400 */
            border-radius: 4px;
        }
        button:disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        .error-shake {
            animation: shake 0.5s ease-in-out;
            border-color: #ef4444 !important; /* Red-500 */
        }
        .input-type-selector label span {
            background-color: #e5e7eb; /* gray-200 */
            color: #4b5563; /* gray-600 */
        }
        .input-type-selector input:checked + span {
            background-color: #2563eb; /* blue-600 */
            color: white;
        }
        
        @media (max-width: 767px) {
            .navbar-links {
                display: none;
            }
             .navbar-brand {
                flex-grow: 1;
                text-align: center;
            }
        }
    </style>
</head>
<body class="bg-gray-50">

    <nav class="navbar" id="navbar">
        <div class="container">
            <a href="index.html" class="navbar-brand">Mako Young</a>
            <div class="navbar-links">
                <a href="index.html#how-it-works">How it Works</a>
                <a href="index.html#benefits">Features</a>
                <div class="dropdown" id="tools-dropdown">
                    <button class="dropdown-button flex items-center gap-1">
                        Tools
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-4 h-4">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                        </svg>
                    </button>
                    <div class="dropdown-menu">
                        <a href="url-opener.html">URL Opener</a>
                        <a href="graphs.html">Graphs</a>
                    </div>
                </div>
                <a href="index.html#contact" class="navbar-button">Book Calls on Autopilot</a>
            </div>
        </div>
    </nav>
    
    <main class="flex items-center justify-center min-h-[calc(100vh-65px)] p-4">
        <div class="w-full max-w-5xl mx-auto">
            <div class="bg-white border border-gray-200 rounded-lg shadow-sm p-6">
                
                <div class="text-center mb-6">
                    <h1 class="text-2xl sm:text-3xl font-bold text-gray-900">Safe URL & IG Opener</h1>
                    <p class="text-gray-500 mt-2">A tool to open URLs or Instagram profiles safely.</p>
                </div>

                <div class="space-y-6">
                     <!-- Input Type Section -->
                     <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Input Type</label>
                        <div class="input-type-selector flex items-center space-x-2 bg-gray-100 p-1 rounded-md">
                            <label for="type-url" class="w-full flex items-center justify-center cursor-pointer">
                                <input type="radio" id="type-url" name="inputType" value="url" class="hidden" checked>
                                <span class="w-full text-center px-3 py-1 text-sm font-semibold rounded-md transition-colors">Full URLs</span>
                            </label>
                            <label for="type-ig" class="w-full flex items-center justify-center cursor-pointer">
                                <input type="radio" id="type-ig" name="inputType" value="instagram" class="hidden">
                                <span class="w-full text-center px-3 py-1 text-sm font-semibold rounded-md transition-colors">Instagram Usernames</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- URL Input Section -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <div class="flex justify-between items-center mb-2">
                                <label for="urls" id="input-label" class="block text-sm font-medium text-gray-700">Paste URLs (one per line)</label>
                                <div class="flex items-center gap-2">
                                    <button id="shuffle-btn" title="Shuffle List" class="bg-gray-200 hover:bg-gray-300 text-gray-600 font-semibold p-2 rounded-md text-xl transition-colors">
                                        üîÄ
                                    </button>
                                     <button id="clear-btn" title="Clear List" class="bg-gray-200 hover:bg-gray-300 text-gray-600 font-semibold p-2 rounded-md text-xl transition-colors">
                                        üóëÔ∏è
                                    </button>
                                </div>
                            </div>
                            <textarea id="urls" rows="10" class="w-full bg-gray-50 border border-gray-300 rounded-md p-3 text-gray-800 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="google.com&#10;github.com"></textarea>
                        </div>
                        <div id="shuffle-preview-container" style="display: none;">
                            <div class="flex justify-between items-center mb-2">
                               <label class="block text-sm font-medium text-gray-500">Shuffled Order</label>
                            </div>
                            <textarea id="shuffled-urls-preview" rows="10" class="w-full bg-gray-100 border border-gray-300 rounded-md p-3 text-gray-500" readonly></textarea>
                        </div>
                    </div>

                    <!-- Delay Settings -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <label for="min-delay" class="block text-sm font-medium text-gray-700 mb-2">Minimum Delay (seconds):</label>
                            <input type="number" id="min-delay" value="7" min="0" class="w-full bg-gray-50 border border-gray-300 rounded-md p-3 text-gray-800 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors">
                        </div>
                        <div>
                            <label for="max-delay" class="block text-sm font-medium text-gray-700 mb-2">Maximum Delay (seconds):</label>
                            <input type="number" id="max-delay" value="11" min="0" class="w-full bg-gray-50 border border-gray-300 rounded-md p-3 text-gray-800 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors">
                        </div>
                    </div>
                    
                    <div class="bg-gray-100 rounded-md px-3 py-2 border border-gray-200">
                        <p id="estimate-time" class="text-sm text-gray-500 text-center"></p>
                    </div>

                    <div class="space-y-4">
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                             <button id="start-btn" class="navbar-button w-full justify-center !py-3">Start Opening</button>
                             <button id="pause-btn" class="navbar-button w-full justify-center !py-3 bg-yellow-500 hover:bg-yellow-600">Pause</button>
                            <button id="stop-btn" class="navbar-button w-full justify-center !py-3 bg-red-500 hover:bg-red-600">Stop</button>
                        </div>
                        <button id="quick-start-btn" class="navbar-button w-full justify-center !py-3 bg-green-500 hover:bg-green-600">Quick Start (for pop-up permission)</button>
                    </div>
                </div>

                <div id="status-container" class="mt-6 text-center p-4 bg-gray-50 border border-gray-200 rounded-md" style="display: none;">
                    <p id="status-message" class="text-gray-700 min-h-[24px]"></p>
                    <p id="countdown-timer" class="text-gray-500 text-sm min-h-[20px]"></p>
                    <div id="progress-bar-container" class="w-full bg-gray-200 rounded-full h-2.5 mt-2" style="display:none;">
                        <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%; transition: width 0.5s ease-in-out;"></div>
                    </div>
                    <div id="report-container" class="mt-4 text-left" style="display: none;">
                        <h3 class="text-lg font-semibold text-gray-900 mb-2">Completion Report</h3>
                        <pre id="report-output" class="text-sm bg-gray-100 border border-gray-200 rounded-md p-4 max-h-48 overflow-y-auto text-gray-600"></pre>
                    </div>
                </div>

                <div class="mt-8 pt-6 border-t border-gray-200 text-left text-gray-500 text-sm space-y-4">
                    <h3 class="text-lg font-semibold text-gray-900">How It Works</h3>
                    <p><strong>Background Processing:</strong> This tool uses a Web Worker to run the timer in the background. This means it will continue to open new tabs even if you switch to another window or tab.</p>
                    <p><strong>Input Type:</strong> Choose 'Full URLs' to open complete web addresses, or 'Instagram Usernames' to automatically open profiles from a list of usernames.</p>
                    <p><strong>Shuffle List:</strong> This button randomizes the order of your list. This adds an extra layer of security by ensuring the links are not opened in a predictable sequence, making the activity appear more human.</p>
                    <p><strong>Quick Start:</strong> This button instantly opens two websites. Its main purpose is to trigger your browser's pop-up permission request right away so you can enable it for this tool without waiting for the normal delay.</p>
                </div>
            </div>
        </div>
    </main>

    <script>
        // --- DOM Element References ---
        const urlTextArea = document.getElementById('urls');
        const minDelayInput = document.getElementById('min-delay');
        const maxDelayInput = document.getElementById('max-delay');
        const shuffleButton = document.getElementById('shuffle-btn');
        const clearButton = document.getElementById('clear-btn');
        const estimateTimeDisplay = document.getElementById('estimate-time');
        const startButton = document.getElementById('start-btn');
        const pauseButton = document.getElementById('pause-btn');
        const stopButton = document.getElementById('stop-btn');
        const quickStartButton = document.getElementById('quick-start-btn');
        const statusContainer = document.getElementById('status-container');
        const statusMessage = document.getElementById('status-message');
        const countdownTimer = document.getElementById('countdown-timer');
        const progressBar = document.getElementById('progress-bar');
        const progressBarContainer = document.getElementById('progress-bar-container');
        const shufflePreviewContainer = document.getElementById('shuffle-preview-container');
        const shufflePreviewTextarea = document.getElementById('shuffled-urls-preview');
        const reportContainer = document.getElementById('report-container');
        const reportOutput = document.getElementById('report-output');
        const inputTypeRadios = document.querySelectorAll('input[name="inputType"]');
        const inputLabel = document.getElementById('input-label');

        // --- State Variables ---
        let isPaused = false;
        let urlWorker;
        let countdownInterval;

        // --- Web Worker Code as a String ---
        const workerScript = `
            let stopProcess = false;
            let isPaused = false;
            let urls = [];
            let minDelay = 0;
            let maxDelay = 0;
            let delayLog = [];

            const sleep = (ms) => new Promise(resolve => setTimeout(resolve, ms));

            self.onmessage = async function(e) {
                const { command, data } = e.data;

                switch (command) {
                    case 'start':
                        urls = data.urls;
                        minDelay = data.minDelay;
                        maxDelay = data.maxDelay;
                        stopProcess = false;
                        isPaused = false;
                        delayLog = [];
                        await processUrls();
                        break;
                    case 'stop':
                        stopProcess = true;
                        break;
                    case 'pause':
                        isPaused = true;
                        break;
                    case 'resume':
                        isPaused = false;
                        break;
                }
            };

            async function processUrls() {
                const processStartTime = Date.now();
                for (let i = 0; i < urls.length; i++) {
                    if (stopProcess) {
                        self.postMessage({ type: 'status', message: 'Process stopped by user.' });
                        break;
                    }

                    while (isPaused) {
                        if (stopProcess) break;
                        await sleep(200);
                    }
                    if (stopProcess) break;

                    self.postMessage({ type: 'open', url: urls[i], index: i, total: urls.length });

                    if (i < urls.length - 1) {
                        const delaySeconds = Math.random() * (maxDelay - minDelay) + minDelay;
                        delayLog.push('Waited ' + delaySeconds.toFixed(1) + 's');
                        self.postMessage({ type: 'delay', seconds: delaySeconds });
                        await sleep(delaySeconds * 1000);
                    }
                }

                if (!stopProcess) {
                    const totalDurationSeconds = ((Date.now() - processStartTime) / 1000).toFixed(1);
                    self.postMessage({ type: 'done', total: urls.length, duration: totalDurationSeconds, log: delayLog });
                }
                self.close();
            }
        `;

        // --- Core Functions ---
        function initializeUI() {
            startButton.disabled = false;
            shuffleButton.disabled = false;
            clearButton.disabled = false;
            pauseButton.disabled = true;
            stopButton.disabled = true;
            pauseButton.textContent = 'Pause';
            shufflePreviewContainer.style.display = 'none';
            reportContainer.style.display = 'none';
            progressBar.style.width = '0%';
            statusMessage.textContent = '';
            countdownTimer.textContent = '';
            statusContainer.style.display = 'none';
            updateInputTypeUI();
            updateEstimate();
        }
        
        function updateInputTypeUI() {
            const selectedType = document.querySelector('input[name="inputType"]:checked').value;
            if (selectedType === 'instagram') {
                inputLabel.textContent = 'Paste Usernames (one per line)';
                urlTextArea.placeholder = 'makoyoung\nexample_user';
            } else {
                inputLabel.textContent = 'Paste URLs (one per line)';
                urlTextArea.placeholder = 'google.com\ngithub.com';
            }
        }

        function updateEstimate() {
            const urls = urlTextArea.value.split('\n').filter(url => url.trim());
            const urlCount = urls.length;
            const minDelay = parseFloat(minDelayInput.value) || 0;
            const maxDelay = parseFloat(maxDelayInput.value) || 0;

            if (urlCount < 2 || minDelay > maxDelay) {
                estimateTimeDisplay.textContent = '';
                return;
            }

            const avgDelay = (minDelay + maxDelay) / 2;
            const totalSeconds = (urlCount - 1) * avgDelay;
            
            if (totalSeconds <= 0) {
                 estimateTimeDisplay.textContent = 'Est. time: ~0s';
                return;
            }

            const minutes = Math.floor(totalSeconds / 60);
            const seconds = Math.round(totalSeconds % 60);

            let estimateString = "Est. time: ";
            if (minutes > 0) estimateString += `${minutes}m `;
            estimateString += `${seconds}s`;
            
            estimateTimeDisplay.textContent = estimateString;
        }

        function startCountdown(secondsRemaining) {
            if (countdownInterval) clearInterval(countdownInterval);
            const startTime = Date.now();
            const totalDurationMs = secondsRemaining * 1000;

            countdownInterval = setInterval(() => {
                const elapsedMs = Date.now() - startTime;
                const remainingMs = totalDurationMs - elapsedMs;
                if (remainingMs > 0) {
                    countdownTimer.textContent = `Next tab in ${(remainingMs / 1000).toFixed(1)}s`;
                } else {
                    countdownTimer.textContent = '';
                    clearInterval(countdownInterval);
                }
            }, 100);
        }

        async function animateShufflePreview(urls) {
            shufflePreviewContainer.style.display = 'block';
            shufflePreviewTextarea.value = '';
            for (const url of urls) {
                shufflePreviewTextarea.value += url + '\n';
                shufflePreviewTextarea.scrollTop = shufflePreviewTextarea.scrollHeight;
                await new Promise(resolve => setTimeout(resolve, 50));
            }
        }

        function shuffleCurrentList() {
            let urls = urlTextArea.value.split('\n').map(url => url.trim()).filter(url => url);
            if (urls.length < 2) return;
            for (let i = urls.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [urls[i], urls[j]] = [urls[j], urls[i]];
            }
            urlTextArea.value = urls.join('\n');
            animateShufflePreview(urls);
        }

        function clearUrlList() {
            urlTextArea.value = '';
            shufflePreviewContainer.style.display = 'none';
            updateEstimate();
        }

        function quickStart() {
            window.open('https://google.com', '_blank');
            window.open('https://youtube.com', '_blank');
        }

        function togglePause() {
            isPaused = !isPaused;
            if (isPaused) {
                urlWorker.postMessage({ command: 'pause' });
                pauseButton.textContent = 'Resume';
                statusMessage.textContent = 'Paused. Click Resume to continue.';
                if (countdownInterval) clearInterval(countdownInterval);
            } else {
                urlWorker.postMessage({ command: 'resume' });
                pauseButton.textContent = 'Pause';
                statusMessage.textContent = 'Resuming...';
            }
        }

        function startProcessing() {
            const selectedType = document.querySelector('input[name="inputType"]:checked').value;
            let urls = urlTextArea.value.split('\n')
                .map(item => item.trim())
                .filter(item => item && !item.startsWith('#'))
                .map(item => {
                    if (selectedType === 'instagram') {
                        return `https://www.instagram.com/${item}`;
                    }
                    if (item.startsWith('http://') || item.startsWith('https://')) {
                        return item;
                    }
                    return `https://${item}`;
                });
            
            const minDelay = parseFloat(minDelayInput.value);
            const maxDelay = parseFloat(maxDelayInput.value);
            
            statusContainer.style.display = 'block';
            reportContainer.style.display = 'none';

            if (urls.length === 0) {
                statusMessage.textContent = "Please provide at least one item.";
                return;
            }
            if (isNaN(minDelay) || isNaN(maxDelay) || minDelay < 0 || maxDelay < 0 || minDelay > maxDelay) {
                statusMessage.textContent = "Please provide valid delays. Min cannot be greater than Max.";
                minDelayInput.classList.add('error-shake');
                maxDelayInput.classList.add('error-shake');
                setTimeout(() => {
                    minDelayInput.classList.remove('error-shake');
                    maxDelayInput.classList.remove('error-shake');
                }, 500);
                return;
            }

            isPaused = false;
            startButton.disabled = true;
            shuffleButton.disabled = true;
            clearButton.disabled = true;
            pauseButton.disabled = false;
            stopButton.disabled = false;
            
            shufflePreviewContainer.style.display = 'none';
            progressBarContainer.style.display = 'block';
            statusMessage.textContent = 'Starting process...';

            const blob = new Blob([workerScript], { type: 'application/javascript' });
            urlWorker = new Worker(URL.createObjectURL(blob));

            urlWorker.onmessage = function(e) {
                const { type, url, index, total, seconds, message, duration, log } = e.data;
                switch(type) {
                    case 'open':
                        progressBar.style.width = `${((index + 1) / total) * 100}%`;
                        statusMessage.textContent = `Opening item ${index + 1} of ${total}: ${url.replace('https://','')}`;
                        window.open(url, '_blank');
                        break;
                    case 'delay':
                        startCountdown(seconds);
                        break;
                    case 'status':
                        statusMessage.textContent = message;
                        break;
                    case 'done':
                        statusMessage.textContent = `Done! All ${total} items have been processed.`;
                        if (countdownInterval) clearInterval(countdownInterval);
                        countdownTimer.textContent = '';
                        
                        let reportContent = 'Delay between tabs:\n---------------------\n';
                        reportContent += log.join('\n') || 'N/A (only one item)';
                        reportContent += `\n\n---------------------\nTotal task time: ${duration}s`;
                        reportOutput.textContent = reportContent;
                        reportContainer.style.display = 'block';
                        
                        initializeUI();
                        urlWorker.terminate();
                        break;
                }
            };
            
            urlWorker.postMessage({
                command: 'start',
                data: { urls, minDelay, maxDelay }
            });
        }

        function stopProcessing() {
            if (urlWorker) {
                urlWorker.postMessage({ command: 'stop' });
                urlWorker.terminate();
            }
            if (countdownInterval) clearInterval(countdownInterval);
            statusMessage.textContent = 'Process stopped by user.';
            initializeUI();
        }

        // --- Event Listeners ---
        startButton.addEventListener('click', startProcessing);
        pauseButton.addEventListener('click', togglePause);
        stopButton.addEventListener('click', stopProcessing);
        shuffleButton.addEventListener('click', shuffleCurrentList);
        clearButton.addEventListener('click', clearUrlList);
        quickStartButton.addEventListener('click', quickStart);
        urlTextArea.addEventListener('input', updateEstimate);
        minDelayInput.addEventListener('input', updateEstimate);
        maxDelayInput.addEventListener('input', updateEstimate);
        inputTypeRadios.forEach(radio => radio.addEventListener('change', updateInputTypeUI));
        
        document.addEventListener('DOMContentLoaded', initializeUI);
    </script>
</body>
</html>
